
<html>
	<head>
		<title>添加访客记录</title>
		
		<meta name="decorator" content="default">
		<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
	    <meta name="renderer" content="webkit">
	    <meta http-equiv="X-UA-Compatible" content="IE=8,IE=9,IE=10">
	    <meta http-equiv="Expires" content="0">
	    <meta http-equiv="Cache-Control" content="no-cache">
	    <meta http-equiv="Cache-Control" content="no-store">
	    <script src="../static/jquery/jquery-1.8.3.min.js" type="text/javascript"></script>
	    <link href="../static/bootstrap/2.3.1/css_cerulean/bootstrap.min.css" type="text/css" rel="stylesheet">
	    <script src="../static/bootstrap/2.3.1/js/bootstrap.min.js" type="text/javascript"></script>
	    <link href="../static/bootstrap/2.3.1/awesome/font-awesome.min.css" type="text/css" rel="stylesheet">
		<script src="../static/bootstrap/bsie/js/bootstrap-ie.min.js" type="text/javascript"></script><![endif]-->
	    <link href="../static/jquery-validation/1.11.0/jquery.validate.min.css" type="text/css" rel="stylesheet">
	    <script src="../static/jquery-validation/1.11.0/jquery.validate.min.js" type="text/javascript"></script>
	    <link href="../static/jquery-jbox/2.3/Skins/Bootstrap/jbox.min.css" rel="stylesheet">
	    <script src="../static/jquery-jbox/2.3/jquery.jBox-2.3.min.js" type="text/javascript"></script>
	    <script src="../static/My97DatePicker/WdatePicker.js" type="text/javascript"></script><link href="../static/My97DatePicker/skin/WdatePicker.css" rel="stylesheet" type="text/css">
	    <script src="../static/common/mustache.min.js" type="text/javascript"></script>
	    <link href="../static/common/smart.min.css" type="text/css" rel="stylesheet">
	    <script src="../static/common/smart.min.js" type="text/javascript"></script>
	    <script src="../static/jquery-form/3.51.0/jquery.form.js" type="text/javascript"></script>
	    <link href="../static/media/css/my-style.css" rel="stylesheet" type="text/css"/>
	    <script type="text/javascript">var ctx = '/admin', ctxStatic='../../static';</script>
	    <script src="../../config/smart-common.js" type="text/javascript"></script>
		
	 	<style>
		   select{
		        height: 26px !important;
		        width: 271px;
		   } 
		   		.form-horizontal .control-group {
    		margin-bottom: 8px;
  	 		 margin-left: -30px;
		}
		</style>
		
		<script type="text/javascript">
				
				// 开启表单验证,调用提交
			    $.validator.setDefaults({
			        submitHandler: function () {
			            formSubmit();
			        }
			    });
				// 提交数据
			    function formSubmit() {
			        var saveData = {
			            headers: {"token": localStorage.getItem("token")},
			            url: APIHost + '/visitor/save',
			            success: function (response) {
			            	if (response.data.msg == "success") {
								parent.hideDiv();
			                    parent.pageload();
								parent.jBox.alert("保存成功 !","提示");
			                } else if (response.code === 1003){
			                	parent.hideDiv();
			                	parent.jBox.alert('请先登录', '提示',{closed: function (){window.parent.location.href= APIHost + "/sys/sysLogin.html";}});
			                } else {
			                	parent.hideDiv();
			                	parent.jBox.alert("操作无效 ,请联系管理员调试 !", "提示");
			                }
			            },
			            beforeSend:function(){
			          		var loading=$('<div id="loading"></div>');
			          		$('body').append(loading);
			          		$("#btnSubmit").attr("disabled",true)
			          	},
			          	complete:function(){
			            	$("#btnSubmit").attr("disabled",false);
			            	$("#loading").hide();
			            }
			        }
			        $("#inputForm").ajaxSubmit(saveData);
			    }

		        // 表单输入校验
				$(document).ready(function() {
			        jQuery.validator.addMethod("isphoneNum", function (value, element) {
			            var length = value.length;
			            return this.optional(element) || (length == 11 );
			        }, "请写长度为11位的号码");
			        $("#inputForm").validate({
			        	rules: {
			        		visitorDate:{
			                	required: true
			                },
			                visitorName:{
			                	required: true
			                },
			                idCard:{
			                	required: true,
			                	rangelength: [18,19],
			                    number:true
			                },
			                comName:{
			                	required: true
			                },
			            	phone: {
			                    required: true,
			                    isphoneNum:true,
			                    number:true
			                },
			                personNum:{
			             	   required: true,
			                   number:true
			                },
			                deptName:{
			                	required: true
			                },
			                visitorMeet:{
			                	required: true
			                },
			                visitorType:{
			                	required: true
			                },
			                toerPersons:{
			                	required: true
			                },
			                beginTime:{
			                	required: true
			                },
			                endTime:{
			                	required: true
			                },
			                remarks:{
			                	required: false
			                }
	               	 	}
	       		  });
			});
			// 取消保存请求		
	        function back(){parent.hideDiv();}
    </script>
	</head>
<body>
	<form id="inputForm" class="form-horizontal"  method="post" class="Wdate" >
	    <input id="id" name="id" type="hidden" value=""/>
        
	    <div class="control-group">
	        <label class="control-label">姓名:</label>
	        <div class="controls">
	            <input id="visitorName" name="visitorName"  type="text" value="" maxlength="50">
	            <font color="red">*</font>
	        </div>
	    </div>
	    <div class="control-group">
	        <label class="control-label">证件号:</label>
	        <div class="controls">
	             <input id="idCard" name="idCard"  type="text" value="" maxlength="50">
	             <font color="red">*</font>
	        </div>
	    </div>
	    <div class="control-group">
	        <label class="control-label">单位:</label>
	        <div class="controls">
	            <input id="comName" name="comName"  type="text" value="" maxlength="50">
	      		<font color="red">*</font>
	        </div>
	    </div>
       <div class="control-group">
	        <label class="control-label">电话:</label>
	        <div class="controls">
	            <input id="phone" name="phone" type="text" value="" maxlength="50">
		        <font color="red">*</font>
	        </div>
        </div>
        <div class="control-group">
	        <label class="control-label">人数:</label>
	        <div class="controls">
	            <input id="personNum" name="personNum"  type="text" value="" maxlength="50">
		        <font color="red">*</font>
	        </div>
        </div>
        <div class="control-group">
	        <label class="control-label">访问部门:</label>
	        <div class="controls">
	            <select id="deptName" name="deptName">
	                    <option id="radio" selected="selected" value="" >请选择</option>
	                    <option value="财务部">财务部</option>
	                    <option value="技术部">技术部</option>
	                    <option value="体育部">体育部</option>
	                    <option value="秘书行政部">秘书行政部</option>
	                    <option value="新闻宣传部">新闻宣传部</option>
	                    <option value="监察审计部">监察审计部</option>
	                    <option value="人力资源部">人力资源部</option>
	                    <option value="总体策划部">总体策划部</option>
	                    <option value="法律事务部">法律事务部</option>
	                    <option value="对外联络部">对外联络部</option>
	                    <option value="市场开发部">市场开发部</option>
	                    <option value="延庆运行中心">延庆运行中心</option>
	                    <option value="运动会服务部">运动会服务部</option>
	                    <option value="张家口运行中心">张家口运行中心</option>
	                    <option value="规划建设和可持续发展部">规划建设和可持续发展部</option>
	            </select>
	            <font color="red">*</font>
	        </div>
        </div>
        <div class="control-group">
	        <label class="control-label">是否预约:</label>
	        <div class="controls">
	            <select id="visitorMeet" name="visitorMeet" >
	                    <option selected="selected" value="">请选择</option>
	                    <option value="是">是</option>
	                    <option value="否">否</option>
	            </select>
	            <font color="red">*</font>
	        </div>
        </div>
        <div class="control-group">
	        <label class="control-label">访客分类:</label>
	        <div class="controls">
	            <select id="visitorType" name="visitorType">
	            	<option selected="selected" value="会见">会见</option>
	            	<option value="施工">施工</option>
	            	<option value="会议">会议</option>
	            </select>
	            <font color="red">*</font>
	        </div>
        </div>
        <div class="control-group">
	        <label class="control-label">被访人姓名:</label>
	        <div class="controls">
	            <input id="toerPersons" name="toerPersons"  type="text" value="" maxlength="50">
	            <font color="red">*</font>
	        </div>
        </div>
        <div class="control-group">
	        <label class="control-label">访问时间:</label>
	        <div class="controls">
	            <input id="beginTime" name="beginTime" class="Wdate" type="text"  onclick="WdatePicker({ dateFmt: 'yyyy-MM-dd HH:mm' })" value="" >
	            <font color="red">*</font>
	        </div>
        </div>
        <div class="control-group">
	        <label class="control-label">离开时间:</label>
	        <div class="controls">
	            <input id=endTime name="endTime" class="Wdate" type="text"  onclick="WdatePicker({ dateFmt: 'yyyy-MM-dd HH:mm' })" value="" >
	            <font color="red">*</font>
	        </div>
        </div>
        <div class="control-group">
	        <label class="control-label">备注:</label>
	        <div class="controls">
	        	<textarea id="remarks" name="remarks" rows="5" cols="40" style="width:270px;resize:none"></textarea>
	        </div>
        </div>
	    <div class="form-actions">
	    	<input id="btnSubmit" class="btn btn-primary" type="submit" value="保  存">&nbsp;
	        <input id="btnCancel" class="btn " type="button" value="返  回"  onclick="back()">
	    </div>
	</form>
	</body>
</html>