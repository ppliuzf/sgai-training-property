<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="renderer" content="webkit">
<meta http-equiv="X-UA-Compatible" content="IE=8,IE=9,IE=10">
<meta http-equiv="Expires" content="0">
<meta http-equiv="Cache-Control" content="no-cache">
<meta http-equiv="Cache-Control" content="no-store">
<script src="../static/jquery/jquery-1.8.3.min.js" type="text/javascript"></script>
<link href="../static/bootstrap/2.3.1/css_cerulean/bootstrap.min.css"
	type="text/css" rel="stylesheet">
<link href="../static/bootstrap/2.3.1/awesome/font-awesome.min.css"
	type="text/css" rel="stylesheet">
<link href="../static/bootstrap/2.3.1/awesome/font-awesome.min.css"
	type="text/css" rel="stylesheet">

<!--分页  -->
<script src="../static/paginator/bootstrap-paginator.js"
	type="text/javascript"></script>
<!-- 公共样式表	，公共方法 -->
<link href="../static/media/css/my-style.css" rel="stylesheet"
	type="text/css" />
<script src="../static/media/js/main.js" type="text/javascript"></script>

<!-- <link href="../static/jquery-select2/4.0/select2.min.css" rel="stylesheet"> -->
<link href="../static/jquery-validation/1.11.0/jquery.validate.min.css"
	type="text/css" rel="stylesheet">
<link href="../static/jquery-jbox/2.3/Skins/Bootstrap/jbox.min.css"
	rel="stylesheet">
<link href="../static/My97DatePicker/skin/WdatePicker.css"
	rel="stylesheet" type="text/css">
<link href="../static/common/smart.min.css" type="text/css"
	rel="stylesheet">
<script src="../static/bootstrap/2.3.1/js/bootstrap.min.js"
	type="text/javascript"></script>
<!-- <script src="../static/jquery-select2/4.0/select2.min.js" type="text/javascript"></script> -->
<script src="../static/jquery-validation/1.11.0/jquery.validate.min.js"
	type="text/javascript"></script>
<script src="../static/jquery-jbox/2.3/jquery.jBox-2.3.src.js"
	type="text/javascript"></script>
<script src="../static/My97DatePicker/WdatePicker.js"
	type="text/javascript"></script>
<script src="../static/common/mustache.min.js" type="text/javascript"></script>
<script src="../static/common/smart.min.js" type="text/javascript"></script>
<script src="../../config/smart-common.js" type="text/javascript"></script>
<script src="../static/wy/area.js" type="text/javascript"></script>
<script src="../static/echart/echarts.js" type="text/javascript"></script>
<style type="text/css">
	.stylelone{
		color: blueviolet;
		font-size: 16px;
		margin-left: 5px;
	}
	.map-title{
		padding:10px;
		border-bottom:1px solid #ddd;
	}
</style>
</head>
<body>
<input type="hidden" value="0" id="flag">
	<div class="table_infor">
		<div class="table_title">
			<i class="icon-table"></i><span>投诉基本信息</span>
		</div>
	</div>
	<hr>
	<div id="chooseDate" class="hide"
	style="position: absolute; border: 1px solid; left: 366px; top: 224px; background: #FFFFFF; width: 400px;  z-index: 100; text-align: center;">

<br />
<label >动态时间：</label>
  <select id="datetype"  name="datetype"   onchange="chooseDynamicTime(this.value)"  class="input-xlarge"  >
  </select>
		
<div id="searchForm" style="display: none;margin-top: -6px;margin-bottom: 6px;">
	<label style="margin-left: 34px;">时间从：</label><input id="startTime"
		name="startTime" class="query_input Wdate" type="text"
		onclick="WdatePicker()"
		style="margin-left: 45px; width: 251px; margin: 4px 20px 1px 1px; height: 24px !important;" />
	<br> <label style="margin-left: 60px;">至：</label><input
		id="endTime" name="endTime" class="query_input Wdate" type="text"
		onclick="WdatePicker()"  onfocus="WdatePicker({onpicked:function(dp){sureData('e'); }})"
		style="margin-left: 45px; width: 251px; margin: 4px 20px 1px 1px; height: 24px !important;" />
</div>

<!-- <input type="button"
	class="btn btn-primary" value="关闭" onclick="closedivChange()" /> -->

</div>

<div id="choosecau" class="hide"
	style="position: absolute; border: 1px solid; left: 381px; top: 600px; background: #FFFFFF; width: 381px;  z-index: 100; text-align: center;">

<br />

<label >动态类型：</label>
  <select id="analtype"  name="analtype"   class="input-xlarge"  >
               <option value=""></option>
               <option value="tssjjg">已提交-已答复平均时长</option>
        </select>
        <label >动态时间：</label>
  <select id="datetype2"  name="datetype"   	onchange="chooseDynamicTime2(this.value)"  class="input-xlarge"  >
  </select>
        
	<div 	id="searchForm2"  style="display: none;margin-top: -6px;margin-bottom: 6px;">
				<label  style="margin-left: 34px;">时间从：</label><input id="startDate" name="startDate"
				class="query_input Wdate" type="text" onclick="WdatePicker()" 
					style="margin-left: 45px;width: 251px;margin: 4px 20px 1px 1px;height: 24px !important;"
				/>
				<br>
			<label  style="margin-left: 60px;">至：</label><input id="endDate" name="endDate"
				class="query_input Wdate" type="text" onclick="WdatePicker()" 
					style="margin-left: 45px;width: 251px;margin: 4px 20px 1px 1px;height: 24px !important;"
					 onfocus="WdatePicker({onpicked:function(dp){analData('e'); }})"
				/>
	</div>
<!-- 		<div style="text-align: center; padding-top: 15px;">
		<input type="button" class="btn btn-primary" value="确定"
			onclick="analData()" /> 
		<input type="button"
			class="btn btn-primary" value="关闭" onclick="closedivChange2()" />
		</div> -->
</div>
	<!-- <div class="stylelone"  id="initCilck">园区事件分布</div>
		<div style="width: 100%; height: 400px;position:relative;" >
		<div style="display:none;width: 1400px; height: 400px;position:absolute;left:-8px;top:0px;background-color: #DDDDDD;z-index: 1;opacity: 0.6;" id="repairMapMask"  >
			</div>
			<div id="echartsEvent" style="width: 1400px;height:400px;margin-left: -150px;"  >
			//chart 
		</div>
		</div> -->
		<div style="width: 100%; height: 403px;position:relative;border:1px solid #ddd;" >
			<div  class="map-title"  id="initCilck">园区事件分布</div>
		<div style="display:none;width: 1400px; height: 400px;position:absolute;left:-8px;top:0px;background-color: #DDDDDD;z-index: 1;opacity: 0.6;" id="repairMapMask"  >
			</div>
			<div id="echartsEvent" style="width: 1400px;height:400px;margin-left: -132px;"  >
			<!-- //chart  -->
			
		</div>
		</div>
		
		<!-- <div style="width: 100%; height: 400px;position:relative;" id="repairAnalMask">
		
				<div style="margin-top: 5px; color: black; font-Size: 15px; font-Weight: normal; font-Family: 宋体; font-Style: normal"
			id="showTitle">已提交-已答复平均时长</div>
		<div style="width: 100%; height: 400px;position:absolute;left:0px;top:0px">
			</div>
			<div id="AnanlEcharts" style="width: 100%; height: 400px; float: left">
			//chart 
			
		</div>
		</div> -->
		<div style="width: 100%; height: 450px;position:relative;border:1px solid #ddd;margin-top: 15px;" id="repairAnalMask">
			<div class="map-title">已提交-已答复平均时长</div>
		<div style="width: 100%; height: 400px;position:absolute;left:0px;top:0px"></div>
		<div id="AnanlEcharts"  style="width: 1100px;height:400px;">
		<!-- //chart  -->
		</div>
		</div>
	<script src="../static/echart/echarts.min.js"></script>
	<script>

	$(document).ready(function(){
		 analData();
	});
	 function optionUtill(data){
		  var res=[];
				for(var i in data){
					var re=data[i];
					for(var j in re){
		                 if(re[j]!=0){
							res.push({
			                    value:re[j],
			                    name:i 	
									})	
		                 }
				}	
	        };
		 var option = {
		        calculable : false,
		       	color: ['#7EC0EE', '#7FFFD4', '#6CA6CD', '#7A67EE', '#48D1CC','#EEDFCC', '#104E8B'],
		        series : [
		            {
		                name:'',
		                type:'treemap',
		                itemStyle: {
		                    normal: {
		                        label: {
		                            show: true,
		                            formatter:  function (params) {
		 	                              var arr = [
		 	 	                                '{name|' + params.name + '}',
		 	 	                                '{budget|事件:' + params.value + '}条'
		 	 	                            ];
		 	 	                            return arr.join('\n');
		 	 	                        },
		 	 	                        rich: {
		 	 	                            budget: {
		 	 	                                fontSize: 14,
		 	 	                                lineHeight: 5,
		 	 	                              	color: '#fff',
		 	 	                            },	 	    
		 	 	                            name: {
		 	 	                                fontSize: 16,
		 	 	                                color: '#fff',
		 	 	                            },
		 	 	                        },
		                          
		                        },
		                        borderWidth: 1
		                    },
		                    emphasis: {
		                        label: {
		                            show: true
		                        }
		                    }
		                },
		                data:res
		            }
		        ]
		    };
		 return option;
	}
		
	  		$.ajax({
	 			headers    : {
	 				"token" : localStorage.getItem("token")
	 			},
	 			url : APIHost + '/todoEvent/treemapComplainData',
	 			type : 'POST',
	 			async : false, //或false,是否异步
	 			timeout : 5000,
	 			dataType : 'json',
	 			success : function(data) {
	 				 var res=[];
	 				res.push({
		                    value:data["naturalEvent"],
		                    name:"自然事件"	
								})	
	 					for(var i in data){
	 						var re=data[i];
	 						for(var j in re){
	 			                 if(re[j]!=0){
	 								res.push({
	 				                    value:re[j],
	 				                    name:i 	
	 										})	
	 			                 }
	 					}
	 	         };
	 			 var option = {
	/*  	 	        tooltip : {
	 	 	            trigger: 'item',
	 	 	            formatter: "{b}: {c}"
	 	 	        }, */
	 	 	       toolbox: {
	 	 	          show : true,
	 	 	         	 orient: 'horizontal',  
	 	 	         	 x:1200,
	 	 	          feature : {
	 	 	             myTool1 : {
	  	 	                show : true,
	  	 	                title : '筛选',
	  	 	               	icon: 'path://M837 139.3L573.2 464.6 562 478.3V853.4L462 803V478.3l-11.2-13.8L187 139.3h650m105-50H82L412 496v337.8l200 100.8V496.1L942 89.3z',
	  	 	                onclick : function (){
	  	 	             	if($("#flag").val()=='1'){
	  	 	         		alert("还有未关闭的窗口!请先关闭，才能点击！");
	  	 	         		return;
	  	 	         	}
	  	 	             $("#flag").val('1');
	  	 	         		$("#chooseDate").show();
	  	 	         		$("#repairMapMask").css("display","block");
	  	 	         	$("#searchForm").hide();
	  	 	             var obj=document.getElementById('datetype');
	  	 	             obj.options.length=0;//移除options 
	  	 	     		$.ajax({
	  	 	     			headers    : {
	  	 	     				"token" : localStorage.getItem("token")
	  	 	     			},
	  	 	     			url : APIHost + '/todoEvent/getDates',
	  	 	     			type : 'POST',
	  	 	     			async : false, //或false,是否异步
	  	 	     			timeout : 5000,
	  	 	     			dataType : 'json',
	  	 	     			success : function(res) {
	  	 	     				$('#datetype').append("<option hidden='hidden' value=''></option>");
	  	 	     				for(i in res){
	  	 	         				$('#datetype').append("<option value="+i+">"+res[i]+"</option>");
	  	 	     				}
	  	 	     			$('#datetype').append("<option  value='custom'>自定义</option>")
	  	 	     			},
	  	 	     			error : function() {
	  	 	     				console.log("错误");
	  	 	     			}
	  	 	     		});
	  	 	                }
	 	 	          } 
	 	 	          }
	 	 	      },
	 	 	        calculable : false,
	 	 	       	color: ['#7EC0EE', '#7FFFD4', '#6CA6CD', '#7A67EE', '#48D1CC','#EEDFCC', '#104E8B'],
	 	 	        series : [
	 	 	            {
	 	 	                name:'',
			              	roam: false,
			                type:'treemap',
			                breadcrumb: {
				                show: false
				            },
	 	 	                itemStyle: {
	 	 	                    normal: {
	 	 	                        label: {
	 	 	                            show: true,
	 	 	                            formatter:  function (params) {
	 	 	                              var arr = [
	 	 	                                '{name|' + params.name + '}',
	 	 	                                '{budget|事件:' + params.value + '}条'
	 	 	                            ];
	 	 	                            return arr.join('\n');
	 	 	                        },
	 	 	                        rich: {
	 	 	                            budget: {
	 	 	                                fontSize: 14,
	 	 	                                lineHeight: 5,
	 	 	                              	color: '#fff',
	 	 	                            },	 	    
	 	 	                            name: {
	 	 	                                fontSize: 16,
	 	 	                                color: '#fff',
	 	 	                            },
	 	 	                        },
	 	 	                           textStyle: {
	 	 	                              color: '#fff',
	 	 	                              fontSize: 15,
	 	 	                          },
	 	 	                        },
	 	 	                        borderWidth: 1
	 	 	                    },
	 	 	                    emphasis: {
	 	 	                        label: {
	 	 	                            show: true
	 	 	                        }
	 	 	                    }
	 	 	                },
	 	 	                data:res
	 	 	            }
	 	 	        ]
	 	 	    };
	 					var myChart = echarts.init(document.getElementById("echartsEvent"));
	           	    	myChart.setOption(option);  
	                     myChart.on('click', function (params) {
	                         var name1=params.name;
	                         if(name1=='自然事件'){
	                        	 return;
	                         }
	                    	 var myChart1 = echarts.init(document.getElementById("echartsEvent"));
	                     	$("#initCilck").html("园区事件分布>>>事件类型分布");
	                     	var or=$("#orderBy").val();
	                     	if(or!='0'){
	                     		return;
	                     	}
	              
		             		$.ajax({
		            			headers    : {
		            				"token" : localStorage.getItem("token")
		            			},
		            			url : APIHost + '/todoEvent/treemapCDataRepair',
		            			type : 'POST',
		            			async : false, //或false,是否异步
		            			timeout : 3000,
		            			data :{
		            				buildName:name1
		            			},
		            			dataType : 'json',
		            			success : function(data) {
		        	                	    myChart1.setOption(optionUtill(data));  
		        	                	    $("#orderBy").val("1");
		            			}
		            		});
	                           });
	 					}  
	 			})
	        
		$("#initCilck").on("click",function(){
	       	$("#initCilck").html("园区事件分布");
		    $("#orderBy").val("0");
		    $("#flag").val('0');
	     		$.ajax({
	    			headers    : {
	    				"token" : localStorage.getItem("token")
	    			},
	    			url : APIHost + '/todoEvent/treemapComplainData',
	    			type : 'POST',
	    			async : false, //或false,是否异步
	    			timeout : 5000,
	    			dataType : 'json',
	    			success : function(data) {
	    				 var res=[];
	 	 				res.push({
		                    value:data["naturalEvent"],
		                    name:"自然事件"	
								})	
	    					for(var i in data){
	    						var re=data[i];
	    						for(var j in re){
	    			                 if(re[j]!=0){
	    								res.push({
	    				                    value:re[j],
	    				                    name:i 	
	    										})	
	    			                 }
	    					}	
	    	         };
	    			 var option = {
	    	 	       toolbox: {
	    	 	          show : true,
	    	 	         	 orient: 'horizontal',  
	    	 	         	 x:1200,
	    	 	          feature : {
	    	 	             myTool1 : {
	     	 	                show : true,
	     	 	                title : '筛选',
	     	 	               	icon: 'path://M837 139.3L573.2 464.6 562 478.3V853.4L462 803V478.3l-11.2-13.8L187 139.3h650m105-50H82L412 496v337.8l200 100.8V496.1L942 89.3z',
	     	 	                onclick : function (){
	     	 	              	if($("#flag").val()=='1'){
	     	 	          		alert("还有未关闭的窗口!请先关闭，才能点击！");
	     	 	          		return;
	     	 	          		}
	     	 	              $("#flag").val('1');
	     	 	         		$("#chooseDate").show();
	     	 	             var obj=document.getElementById('datetype');
	     	 	             obj.options.length=0;//移除options 
	     	 	     		$.ajax({
	     	 	     			headers    : {
	     	 	     				"token" : localStorage.getItem("token")
	     	 	     			},
	     	 	     			url : APIHost + '/todoEvent/getDates',
	     	 	     			type : 'POST',
	     	 	     			async : false, //或false,是否异步
	     	 	     			timeout : 5000,
	     	 	     			dataType : 'json',
	     	 	     			success : function(res) {
	     	 	     				$('#datetype').append("<option hidden='hidden' value=''></option>");
	     	 	     				for(i in res){
	     	 	         				$('#datetype').append("<option value="+i+">"+res[i]+"</option>");
	     	 	     				}
	     	 	     				$('#datetype').append("<option  value='custom'>自定义</option>")
	     	 	     			},
	     	 	     			error : function() {
	     	 	     				console.log("错误");
	     	 	     			}
	     	 	     		});
	     	 	                }
	    	 	          } 
	    	 	          }
	    	 	      },
	    	 	        calculable : false,
	    	 	       	color: ['#7EC0EE', '#7FFFD4', '#6CA6CD', '#7A67EE', '#48D1CC','#EEDFCC', '#104E8B'],
	    	 	        series : [
	    	 	            {
	    	 	                name:'',
	    	 	              	roam: false,
	    	 	                type:'treemap',
	    	 	                itemStyle: {
	    	 	                    normal: {
	    	 	                        label: {
	    	 	                            show: true,
	    	 	                            formatter:  function (params) {
	    	 	 	                              var arr = [
	    	 	 	 	                                '{name|' + params.name + '}',
	    	 	 	 	                                '{budget|事件:' + params.value + '}条'
	    	 	 	 	                            ];
	    	 	 	 	                            return arr.join('\n');
	    	 	 	 	                        },
	    	 	 	 	                        rich: {
	    	 	 	 	                            budget: {
	    	 	 	 	                                fontSize: 14,
	    	 	 	 	                                lineHeight: 5,
	    	 	 	 	                              	color: '#fff',
	    	 	 	 	                            },	 	    
	    	 	 	 	                            name: {
	    	 	 	 	                                fontSize: 16,
	    	 	 	 	                                color: '#fff',
	    	 	 	 	                            },
	    	 	 	 	                        },
	    	 	                           textStyle: {
	    	 	                              color: '#fff',
	    	 	                              fontSize: 15,
	    	 	                          },
	    	 	                        },
	    	 	                        borderWidth: 1
	    	 	                    },
	    	 	                    emphasis: {
	    	 	                        label: {
	    	 	                            show: true
	    	 	                        }
	    	 	                    }
	    	 	                },
	    	 	                data:res
	    	 	            }
	    	 	        ]
	    	 	    };
	   			 			var myChart = echarts.init(document.getElementById("echartsEvent"));
	                	    myChart.setOption(option);  
	                        myChart.on('click', function (params) {
	                        	var name1=params.name;
	                        	if(name1=='自然事件'){
	                        		return;
	                        	}
	                        	$("#initCilck").html("园区事件分布>>>事件类型分布");
	                                 	var or=$("#orderBy").val();
	                                 	if(or!='0'){
	                                 		return
	                                 	}
					             		$.ajax({
					            			headers    : {
					            				"token" : localStorage.getItem("token")
					            			},
					            			url : APIHost + '/todoEvent/treemapCDataRepair',
					            			type : 'POST',
					            			async : false, //或false,是否异步
					            			timeout : 3000,
					            			data :{
					            				buildName:name1
					            			},
					            			dataType : 'json',
					            			success : function(data) {
					        	                	    var myChart1 = echarts.init(document.getElementById("echartsEvent"));
					        	                	    myChart1.setOption(optionUtill(data));  	
					        	                	    $("#orderBy").val("1");
					            			}
					            		});
	                              });
	    			}  
	    			})
	       });
	  		
function chooseDynamicTime(value){
	$("#startTime").val("");
	$("#endTime").val("");
	if('custom'==value){
		$("#searchForm").show();
	}else{
		$("#searchForm").hide();
		sureData();
	}
}

function sureData(){
	$("#chooseDate").hide();
	$("#flag").val('0');
		$("#repairMapMask").css("display","none");
 		$.ajax({
			headers    : {
				"token" : localStorage.getItem("token")
			},
			url : APIHost + '/todoEvent/treemapComplainData',
			type : 'POST',
			async : false, //或false,是否异步
			timeout : 5000,
			dataType : 'json',
			data:{
				type:$("#datetype").val(),
				createdDt:$("#startTime").val(),
				updatedDt:$("#endTime").val(),
			},
			success : function(data) {
				 var res=[];
	 				res.push({
	                    value:data["naturalEvent"],
	                    name:"自然事件"	
							});	
					for(var i in data){
						var re=data[i];
						for(var j in re){
			                 if(re[j]!=0){
								res.push({
				                    value:re[j],
				                    name:i 	
										})	
			                 }
					}	
	         };
			 var option = {
/* 	 	        tooltip : {
	 	            trigger: 'item',
	 	            formatter: "{b}: {c}"
	 	        }, */
	 	       toolbox: {
	 	          show : true,
	 	         	 orient: 'horizontal',  
	 	         	 x:1200,
	 	          feature : {
	 	             myTool1 : {
 	 	                show : true,
 	 	                title : '筛选',
 	 	               	icon: 'path://M837 139.3L573.2 464.6 562 478.3V853.4L462 803V478.3l-11.2-13.8L187 139.3h650m105-50H82L412 496v337.8l200 100.8V496.1L942 89.3z',
 	 	                onclick : function (){
 	 	              	if($("#flag").val()=='1'){
 	 	          		alert("还有未关闭的窗口!请先关闭，才能点击！");
 	 	          		return;
 	 	          	}
 	 	              $("#flag").val('1');
 	 	         		$("#chooseDate").show();
 	 	         		$("#repairMapMask").css("display","block");
 	 	         		$("#searchForm").hide();
 	 	             var obj=document.getElementById('datetype');
 	 	             obj.options.length=0;//移除options 
 	 	     		$.ajax({
 	 	     			headers    : {
 	 	     				"token" : localStorage.getItem("token")
 	 	     			},
 	 	     			url : APIHost + '/todoEvent/getDates',
 	 	     			type : 'POST',
 	 	     			async : false, //或false,是否异步
 	 	     			timeout : 5000,
 	 	     			dataType : 'json',
 	 	     			success : function(res) {
 	 	     				$('#datetype').append("<option hidden='hidden' value=''></option>");
 	 	     				for(i in res){
 	 	         				$('#datetype').append("<option value="+i+">"+res[i]+"</option>");
 	 	     				}
 	 	  					$('#datetype').append("<option  value='custom'>自定义</option>")
 	 	     			},
 	 	     			error : function() {
 	 	     				console.log("错误");
 	 	     			}
 	 	     		});
 	 	                }
	 	          } 
	 	          }
	 	      },
	 	        calculable : false,
	 	       	color: ['#7EC0EE', '#7FFFD4', '#6CA6CD', '#7A67EE', '#48D1CC','#EEDFCC', '#104E8B'],
	 	        series : [
	 	            {
	 	                name:'',
	 	              	roam: false,
	 	                type:'treemap',
	 	                itemStyle: {
	 	                    normal: {
	 	                        label: {
	 	                            show: true,
	 	                            formatter:  function (params) {
		 	                              var arr = [
		 	 	                                '{name|' + params.name + '}',
		 	 	                                '{budget|事件:' + params.value + '}条'
		 	 	                            ];
		 	 	                            return arr.join('\n');
		 	 	                        },
		 	 	                        rich: {
		 	 	                            budget: {
		 	 	                                fontSize: 14,
		 	 	                                lineHeight: 5,
		 	 	                              	color: '#fff',
		 	 	                            },	 	    
		 	 	                            name: {
		 	 	                                fontSize: 16,
		 	 	                                color: '#fff',
		 	 	                            },
		 	 	                        },
		                          
	 	                          
	 	                        },
	 	                        borderWidth: 1
	 	                    },
	 	                    emphasis: {
	 	                        label: {
	 	                            show: true
	 	                        }
	 	                    }
	 	                },
	 	                data:res
	 	            }
	 	        ]
	 	    };
			 			var myChart = echarts.init(document.getElementById("echartsEvent"));
                	    myChart.setOption(option);  
                       myChart.on('click', function (params) {
                 			var name1=params.name;
                 			if(name1=='自然事件'){
                 				return;
                 			}
                       	$("#initCilck").html("园区事件分布>>>事件类型分布");
                                 	var or=$("#orderBy").val();
                                 	if(or!='0'){
                                 		return
                                 	}
			             		$.ajax({
			            			headers    : {
			            				"token" : localStorage.getItem("token")
			            			},
			            			url : APIHost + '/todoEvent/treemapCDataRepair',
			            			type : 'POST',
			            			async : false, //或false,是否异步
			            			timeout : 3000,
			            			data :{
			            				buildName:name1
			            			},
			            			dataType : 'json',
			            			success : function(data) {
			        	                	    var myChart1 = echarts.init(document.getElementById("echartsEvent"));
			        	                	    myChart1.setOption(optionUtill(data)); 
			        	                	    $("#orderBy").val("1");
			            			}
			            		});
                             });
			}  
			})
} 
function analData(){
	$("#flag").val('0');
	$("#choosecau").hide();
	$("#repairAnalMask").css("background","#FFFFFF");
	var ctype=$("#analtype").val();
    var textName="投诉工单时间间隔对比";
	$.ajax({
		headers    : {
			"token" : localStorage.getItem("token")
		},
		url : APIHost + '/todoEvent/repairAnalysisTGI',
		type : 'POST',
		async : false, //或false,是否异步
		timeout : 3000,
		data :{
			analtype:$("#analtype").val()==''?'tssjjg':$("#analtype").val(),
			type:$("#datetype2").val()==''?'b':$("#datetype2").val(),
			createdDt:$("#startDate").val(),
			updatedDt:$("#endDate").val(),
		},
		dataType : 'json',
		success : function(data) {
			var yaxis=[];
			var xaxis=[];
			var xaxisf=[];
			var level=data['repairLevel'];
			for(var k in data){
				if(k!='repairLevel'){
					yaxis.push(k);
					xaxis.push(data[k]); 
				}
			}
			option = {
				    title: {
					    subtext: '基于园区TGI : '+level,
				     	left: '38%',
				        top: '20',
				        textAlign: 'center',
				        subtextStyle:{
				            fontSize:14
			       		 }
				    },
    		        toolbox: {  
    		            show : true,  
    		            feature : {  
    		            myTool : {  
    		                    show : true,  
    		                    title : '筛选',  
    		                    icon: 'path://M837 139.3L573.2 464.6 562 478.3V853.4L462 803V478.3l-11.2-13.8L187 139.3h650m105-50H82L412 496v337.8l200 100.8V496.1L942 89.3z',
    		                    onclick : function (){
    		                    	if($("#flag").val()=='1'){
    		                    		alert("还有未关闭的窗口!请先关闭，才能点击！");
    		                    		return;
    		                    	}
    		                    	$("#flag").val('1');
    		                    	$("#choosecau").show();
    		                    	$("#repairAnalMask").css("background","#DDDDDD");
    		                    	$("#searchForm2").hide();
    		              		  var obj=document.getElementById('datetype2');
    		              	        obj.options.length=0;//移除options 
    		              			$.ajax({
    		              				headers    : {
    		              					"token" : localStorage.getItem("token")
    		              				},
    		              				url : APIHost + '/todoEvent/getDates',
    		              				type : 'POST',
    		              				async : false, //或false,是否异步
    		              				timeout : 5000,
    		              				dataType : 'json',
    		              				contentType: "application/json; charset=utf-8",
    		              				success : function(res) {
    		              					$('#datetype2').append("<option hidden='hidden' value=''></option>");
    		              					for(i in res){
    		              	    				$('#datetype2').append("<option value="+i+">"+res[i]+"</option>");
    		              					}
    		              					$('#datetype2').append("<option  value='custom'>自定义</option>")
    		            				},
    		              				error : function() {
    		              					console.log("错误");
    		              				}
    		              			});
    		                    }  
    		                 } 
    		            }  
    		        },
				    tooltip : {
				        trigger: 'axis',
				        axisPointer : {            // 坐标轴指示器，坐标轴触发有效
				            type : 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
				        },
                        formatter:  function (params) {
                            var arr=[];
                            if(params[0].value==0){
                            	 return arr.join('');
                            }
                            var k= '<div class="tooltip-title">' +params[0].name+ '的'+textName+ ':&nbsp;&nbsp;'+params[0].value +'</div>';
                        	var n=0;
                            if(params[0].value<0){
                        		n=params[0].value+level;
                        	}else{
                        		n=params[0].value-level;
                        	}
                            var m='高于/低于园区平均水平: &nbsp;&nbsp;' + n.toFixed(2) + '<br>';
                        	var l= '园区'+textName+': &nbsp;&nbsp;'+level;
                            arr.push(k);
                            arr.push(m);
                            arr.push(l);
                            return arr.join('')
	                        },
				    },
				    legend: {
				        data:['']
				    },
				    grid: {
				        left: '3%',     
				        right: '4%',
				        bottom: '3%',
				        containLabel: true
				    },
				    xAxis : [
				        {
				            type : 'value',
				            axisTick: {  //是否显示刻度线
				                show: false
				            },
				            boundaryGap:["1","1"],  
				            axisLabel: {
				            	show: false //这行代码控制着坐标轴x轴的文字是否显示
				            	},
				        },

				    ],
				    yAxis : [
				        {
				            type : 'category',
					        name: textName,
					        nameLocation: 'center',
					        nameGap: '85',
					        nameTextStyle: {
					            fontSize: 17,
					            fontWeight:'bold'   
					        },
				            axisTick : {show: false},
				            data : yaxis
				        }
				    ],
				    series : [
				        {
				            name:'偏高',
				            type:'bar',
				            label: {
				                normal: {
				                    show: true,
				                    position: 'inside'
				                }
				            },
				            data:xaxis,
				            itemStyle: {
				                normal: {
	/* 			                    color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
				                        offset: 0,
				                        color: '#008cff'
				                    }, {
				                        offset: 1,
				                        color: '#fff'
				                    }]), */
				             //       color:'#008cff',
				                    color: function (params) {
		 	                              if(params.value>0){
		 	                            	  return '#008cff';
		 	                              }else if(params.value<0){
		 	                            	 return '#FF4500'; 
		 	                              }else{
		 	                            	 return '#FFFFFF'; 
		 	                              }
		 	 	                        },
				                    opacity: 1,
				                }
				            }
				        }/* ,     
				        {
				            name:'偏低',
				            type:'bar',
				            stack: '总量',
				            label: {
				                normal: {
				                    show: true,
				                    position: 'left'
				                }
				            },
				            data:xaxisf
				        } */
				    ]
				};
			var myChart = echarts.init(document.getElementById('AnanlEcharts')); 
			myChart.setOption(option);
	
		}
	});
}
function chooseDynamicTime2(value){
	$("#startDate").val("");
	$("#endDate").val("");
	if('custom'==value){
		$("#searchForm2").show();
	}else{
		$("#searchForm2").hide();
		analData();
	}
}
	</script>
	<input id="orderBy" name="orderBy" type="hidden" value="0">
	<input type="hidden" value="0" id="flag">
</body>
</html>